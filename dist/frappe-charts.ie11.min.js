"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(b){return typeof b}:function(b){return b&&"function"==typeof Symbol&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},Chart=function(){"use strict";function b(O,P){return"string"==typeof O?(P||document).querySelector(O):O||null}function j(O){return parseFloat(O.toFixed(2))}function k(O,P){if(O.length!==P.length)return!1;var Q=!0;return O.map(function(R,S){P[S]!==R&&(Q=!1)}),Q}!function(O,P){if("undefined"==typeof document)return P;O=O||"";var Q=document.head||document.getElementsByTagName("head")[0],R=document.createElement("style");R.type="text/css",Q.appendChild(R),R.styleSheet?R.styleSheet.cssText=O:R.appendChild(document.createTextNode(O))}(".chart-container{font-family:Roboto,Geneva,Tahoma,sans-serif}.chart-container .graph-focus-margin{margin:0 5%}.chart-container>.title{margin-top:25px;margin-left:25px;text-align:left;font-weight:400;font-size:12px;color:#6c7680}.chart-container .graphics{margin-top:10px;padding-top:10px;padding-bottom:10px;position:relative}.chart-container .graph-stats-group{-ms-flex-pack:distribute;-webkit-box-flex:1;-ms-flex:1;flex:1}.chart-container .graph-stats-container,.chart-container .graph-stats-group{display:-webkit-box;display:-ms-flexbox;display:flex;justify-content:space-around}.chart-container .graph-stats-container{-ms-flex-pack:distribute;padding-top:10px}.chart-container .graph-stats-container .stats{padding-bottom:15px}.chart-container .graph-stats-container .stats-title{color:#8d99a6}.chart-container .graph-stats-container .stats-value{font-size:20px;font-weight:300}.chart-container .graph-stats-container .stats-description{font-size:12px;color:#8d99a6}.chart-container .graph-stats-container .graph-data .stats-value{color:#98d85b}.chart-container .axis,.chart-container .chart-label{font-size:11px;fill:#555b51}.chart-container .axis line,.chart-container .chart-label line{stroke:#dadada}.chart-container .percentage-graph .progress{margin-bottom:0}.chart-container .data-points circle{stroke:#fff;stroke-width:2}.chart-container .path-group path{fill:none;stroke-opacity:1;stroke-width:2px}.chart-container line.dashed{stroke-dasharray:5,3}.chart-container .tick.x-axis-label{display:block}.chart-container .tick .specific-value{text-anchor:start}.chart-container .tick .y-value-text{text-anchor:end}.chart-container .tick .x-value-text{text-anchor:middle}.chart-container .progress{height:20px;margin-bottom:20px;overflow:hidden;background-color:#f5f5f5;border-radius:4px;-webkit-box-shadow:inset 0 1px 2px rgba(0,0,0,.1);box-shadow:inset 0 1px 2px rgba(0,0,0,.1)}.chart-container .progress-bar{float:left;width:0;height:100%;font-size:12px;line-height:20px;color:#fff;text-align:center;background-color:#36414c;-webkit-box-shadow:inset 0 -1px 0 rgba(0,0,0,.15);box-shadow:inset 0 -1px 0 rgba(0,0,0,.15);-webkit-transition:width .6s ease;transition:width .6s ease}.graph-svg-tip{position:absolute;z-index:1;padding:10px;font-size:12px;color:#959da5;text-align:center;background:rgba(0,0,0,.8);border-radius:3px}.graph-svg-tip ol,.graph-svg-tip ul{padding-left:0;display:-webkit-box;display:-ms-flexbox;display:flex}.graph-svg-tip ul.data-point-list li{min-width:90px;-webkit-box-flex:1;-ms-flex:1;flex:1;font-weight:600}.graph-svg-tip strong{color:#dfe2e5;font-weight:600}.graph-svg-tip .svg-pointer{position:absolute;bottom:-10px;left:50%;width:5px;height:5px;margin:0 0 0 -5px;content:\" \";border:5px solid transparent;border-top-color:rgba(0,0,0,.8)}.graph-svg-tip.comparison{padding:0;text-align:left;pointer-events:none}.graph-svg-tip.comparison .title{display:block;padding:10px;margin:0;font-weight:600;line-height:1;pointer-events:none}.graph-svg-tip.comparison ul{margin:0;white-space:nowrap;list-style:none}.graph-svg-tip.comparison li{display:inline-block;padding:5px 10px}.indicator,.indicator-right{background:none;font-size:12px;vertical-align:middle;font-weight:700;color:#6c7680}.indicator-right:after,.indicator:before{content:\"\";display:inline-block;height:8px;width:8px;border-radius:8px}.indicator:before{margin:0 4px 0 0}.indicator-right:after{margin:0 0 0 4px}.background.grey,.indicator-right.grey:after,.indicator.grey:before{background:#bdd3e6}.background.light-grey,.indicator-right.light-grey:after,.indicator.light-grey:before{background:#f0f4f7}.background.blue,.indicator-right.blue:after,.indicator.blue:before{background:#5e64ff}.background.red,.indicator-right.red:after,.indicator.red:before{background:#ff5858}.background.green,.indicator-right.green:after,.indicator.green:before{background:#28a745}.background.light-green,.indicator-right.light-green:after,.indicator.light-green:before{background:#98d85b}.background.orange,.indicator-right.orange:after,.indicator.orange:before{background:#ffa00a}.background.violet,.indicator-right.violet:after,.indicator.violet:before{background:#743ee2}.background.dark-grey,.indicator-right.dark-grey:after,.indicator.dark-grey:before{background:#b8c2cc}.background.black,.indicator-right.black:after,.indicator.black:before{background:#36414c}.background.yellow,.indicator-right.yellow:after,.indicator.yellow:before{background:#feef72}.background.light-blue,.indicator-right.light-blue:after,.indicator.light-blue:before{background:#7cd6fd}.background.purple,.indicator-right.purple:after,.indicator.purple:before{background:#b554ff}.background.magenta,.indicator-right.magenta:after,.indicator.magenta:before{background:#ffa3ef}.stroke.grey{stroke:#bdd3e6}.stroke.light-grey{stroke:#f0f4f7}.stroke.blue{stroke:#5e64ff}.stroke.red{stroke:#ff5858}.stroke.light-green{stroke:#98d85b}.stroke.green{stroke:#28a745}.stroke.orange{stroke:#ffa00a}.stroke.violet{stroke:#743ee2}.stroke.dark-grey{stroke:#b8c2cc}.stroke.black{stroke:#36414c}.stroke.yellow{stroke:#feef72}.stroke.light-blue{stroke:#7cd6fd}.stroke.purple{stroke:#b554ff}.stroke.magenta{stroke:#ffa3ef}.fill.grey{fill:#bdd3e6}.fill.light-grey{fill:#f0f4f7}.fill.blue{fill:#5e64ff}.fill.red{fill:#ff5858}.fill.light-green{fill:#98d85b}.fill.green{fill:#28a745}.fill.orange{fill:#ffa00a}.fill.violet{fill:#743ee2}.fill.dark-grey{fill:#b8c2cc}.fill.black{fill:#36414c}.fill.yellow{fill:#feef72}.fill.light-blue{fill:#7cd6fd}.fill.purple{fill:#b554ff}.fill.magenta{fill:#ffa3ef}.border-top.grey{border-top:3px solid #bdd3e6}.border-top.light-grey{border-top:3px solid #f0f4f7}.border-top.blue{border-top:3px solid #5e64ff}.border-top.red{border-top:3px solid #ff5858}.border-top.light-green{border-top:3px solid #98d85b}.border-top.green{border-top:3px solid #28a745}.border-top.orange{border-top:3px solid #ffa00a}.border-top.violet{border-top:3px solid #743ee2}.border-top.dark-grey{border-top:3px solid #b8c2cc}.border-top.black{border-top:3px solid #36414c}.border-top.yellow{border-top:3px solid #feef72}.border-top.light-blue{border-top:3px solid #7cd6fd}.border-top.purple{border-top:3px solid #b554ff}.border-top.magenta{border-top:3px solid #ffa3ef}.stop-color.grey{stop-color:#bdd3e6}.stop-color.light-grey{stop-color:#f0f4f7}.stop-color.blue{stop-color:#5e64ff}.stop-color.red{stop-color:#ff5858}.stop-color.light-green{stop-color:#98d85b}.stop-color.green{stop-color:#28a745}.stop-color.orange{stop-color:#ffa00a}.stop-color.violet{stop-color:#743ee2}.stop-color.dark-grey{stop-color:#b8c2cc}.stop-color.black{stop-color:#36414c}.stop-color.yellow{stop-color:#feef72}.stop-color.light-blue{stop-color:#7cd6fd}.stop-color.purple{stop-color:#b554ff}.stop-color.magenta{stop-color:#ffa3ef}",void 0);var q="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(O){return"undefined"==typeof O?"undefined":_typeof(O)}:function(O){return O&&"function"==typeof Symbol&&O.constructor===Symbol&&O!==Symbol.prototype?"symbol":"undefined"==typeof O?"undefined":_typeof(O)},w=(function(){function O(Q){this.value=Q}function P(Q){function R(V,W){try{var X=Q[V](W),Y=X.value;Y instanceof O?Promise.resolve(Y.value).then(function(Z){R("next",Z)},function(Z){R("throw",Z)}):S(X.done?"return":"normal",X.value)}catch(Z){S("throw",Z)}}function S(V,W){"return"===V?T.resolve({value:W,done:!0}):"throw"===V?T.reject(W):T.resolve({value:W,done:!1});(T=T.next)?R(T.key,T.arg):U=null}var T,U;this._invoke=function(V,W){return new Promise(function(X,Y){var Z={key:V,arg:W,resolve:X,reject:Y,next:null};U?U=U.next=Z:(T=U=Z,R(V,W))})},"function"!=typeof Q.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(P.prototype[Symbol.asyncIterator]=function(){return this}),P.prototype.next=function(Q){return this._invoke("next",Q)},P.prototype.throw=function(Q){return this._invoke("throw",Q)},P.prototype.return=function(Q){return this._invoke("return",Q)}}(),function(O,P){if(!(O instanceof P))throw new TypeError("Cannot call a class as a function")}),z=function(){function O(P,Q){for(var S,R=0;R<Q.length;R++)S=Q[R],S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(P,S.key,S)}return function(P,Q,R){return Q&&O(P.prototype,Q),R&&O(P,R),P}}(),A=function O(P,Q,R){null===P&&(P=Function.prototype);var S=Object.getOwnPropertyDescriptor(P,Q);if(void 0===S){var T=Object.getPrototypeOf(P);return null===T?void 0:O(T,Q,R)}if("value"in S)return S.value;var U=S.get;if(void 0!==U)return U.call(R)},B=function(O,P){if("function"!=typeof P&&null!==P)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof P?"undefined":_typeof(P)));O.prototype=Object.create(P&&P.prototype,{constructor:{value:O,enumerable:!1,writable:!0,configurable:!0}}),P&&(Object.setPrototypeOf?Object.setPrototypeOf(O,P):O.__proto__=P)},C=function(O,P){if(!O)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return P&&("object"==("undefined"==typeof P?"undefined":_typeof(P))||"function"==typeof P)?P:O},D=function(){function O(P,Q){var R=[],S=!0,T=!1,U;try{for(var V,W=P[Symbol.iterator]();!(S=(V=W.next()).done)&&(R.push(V.value),!Q||R.length!==Q);S=!0);}catch(X){T=!0,U=X}finally{try{!S&&W.return&&W.return()}finally{if(T)throw U}}return R}return function(P,Q){if(Array.isArray(P))return P;if(Symbol.iterator in Object(P))return O(P,Q);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),E=function(O){if(Array.isArray(O)){for(var P=0,Q=Array(O.length);P<O.length;P++)Q[P]=O[P];return Q}return Array.from(O)};b.findNodeIndex=function(O){for(var P=0;O.previousSibling;)O=O.previousSibling,P++;return P},b.create=function(O,P){var Q=document.createElement(O);for(var R in P){var S=P[R];if("inside"==R)b(S).appendChild(Q);else if("around"==R){var T=b(S);T.parentNode.insertBefore(Q,T),Q.appendChild(T)}else"styles"==R?"object"===(void 0===S?"undefined":q(S))&&Object.keys(S).map(function(U){Q.style[U]=S[U]}):R in Q?Q[R]=S:Q.setAttribute(R,S)}return Q},b.createSVG=function(O,P){var Q=document.createElementNS("http://www.w3.org/2000/svg",O);for(var R in P){var S=P[R];if("inside"==R)b(S).appendChild(Q);else if("around"==R){var T=b(S);T.parentNode.insertBefore(Q,T),Q.appendChild(T)}else"className"==R&&(R="class"),"innerHTML"==R?Q.textContent=S:Q.setAttribute(R,S)}return Q},b.runSVGAnimation=function(O,P){var Q=[],R=[];P.map(function(T){var U=T[0],V=U.unit.parentNode,W,X;T[0]=U.unit;var Y=b.animateSVG.apply(b,E(T)),Z=D(Y,2);W=Z[0],X=Z[1],Q.push(X),R.push([W,V]),V.replaceChild(W,U.unit),U.array?U.array[U.index]=X:U.object[U.key]=X});var S=O.cloneNode(!0);return R.map(function(T,U){T[1].replaceChild(Q[U],T[0]),P[U][0]=Q[U]}),S},b.animateSVG=function(O,P,Q){var R=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"linear",S=4<arguments.length&&void 0!==arguments[4]?arguments[4]:void 0,T=5<arguments.length&&void 0!==arguments[5]?arguments[5]:{},U={ease:"0.25 0.1 0.25 1",linear:"0 0 1 1",easein:"0.1 0.8 0.2 1",easeout:"0 0 0.58 1",easeinout:"0.42 0 0.58 1"},V=O.cloneNode(!0),W=O.cloneNode(!0);for(var X in P){var Y=void 0;Y="transform"==X?document.createElementNS("http://www.w3.org/2000/svg","animateTransform"):document.createElementNS("http://www.w3.org/2000/svg","animate");var Z=T[X]||O.getAttribute(X),$=P[X],aa={attributeName:X,from:Z,to:$,begin:"0s",dur:Q/1e3+"s",values:Z+";"+$,keySplines:U[R],keyTimes:"0;1",calcMode:"spline",fill:"freeze"};for(var ba in S&&(aa.type=S),aa)Y.setAttribute(ba,aa[ba]);V.appendChild(Y),S?W.setAttribute(X,"translate("+$+")"):W.setAttribute(X,$)}return[V,W]},b.offset=function(O){var P=O.getBoundingClientRect();return{top:P.top+(document.documentElement.scrollTop||document.body.scrollTop),left:P.left+(document.documentElement.scrollLeft||document.body.scrollLeft)}},b.isElementInViewport=function(O){var P=O.getBoundingClientRect();return 0<=P.top&&0<=P.left&&P.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&P.right<=(window.innerWidth||document.documentElement.clientWidth)},b.bind=function(O,P){if(O)for(var Q in P){var R=P[Q];Q.split(/\s+/).forEach(function(S){O.addEventListener(S,R)})}},b.unbind=function(O,P){if(O)for(var Q in P){var R=P[Q];Q.split(/\s+/).forEach(function(S){O.removeEventListener(S,R)})}},b.fire=function(O,P,Q){var R=document.createEvent("HTMLEvents");for(var S in R.initEvent(P,!0,!0),Q)R[S]=Q[S];return O.dispatchEvent(R)};var F=function(){function O(P){var Q=P.parent,R=void 0===Q?null:Q;w(this,O),this.parent=R,this.title_name="",this.title_value="",this.list_values=[],this.title_value_first=0,this.x=0,this.y=0,this.top=0,this.left=0,this.setup()}return z(O,[{key:"setup",value:function value(){this.make_tooltip()}},{key:"refresh",value:function value(){this.fill(),this.calc_position()}},{key:"make_tooltip",value:function value(){var P=this;this.container=b.create("div",{inside:this.parent,className:"graph-svg-tip comparison",innerHTML:"<span class=\"title\"></span>\n\t\t\t\t<ul class=\"data-point-list\"></ul>\n\t\t\t\t<div class=\"svg-pointer\"></div>"}),this.hide_tip(),this.title=this.container.querySelector(".title"),this.data_point_list=this.container.querySelector(".data-point-list"),this.parent.addEventListener("mouseleave",function(){P.hide_tip()})}},{key:"fill",value:function value(){var P=this,Q;Q=this.title_value_first?"<strong>"+this.title_value+"</strong>"+this.title_name:this.title_name+"<strong>"+this.title_value+"</strong>",this.title.innerHTML=Q,this.data_point_list.innerHTML="",this.list_values.map(function(R){var S=b.create("li",{className:"border-top "+(R.color||"black"),innerHTML:"<strong style=\"display: block;\">"+(R.value?R.value:"")+"</strong>\n\t\t\t\t\t"+(R.title?R.title:"")});P.data_point_list.appendChild(S)})}},{key:"calc_position",value:function value(){this.top=this.y-this.container.offsetHeight,this.left=this.x-this.container.offsetWidth/2;var P=this.parent.offsetWidth-this.container.offsetWidth,Q=this.container.querySelector(".svg-pointer");if(0>this.left)Q.style.left="calc(50% - "+-1*this.left+"px)",this.left=0;else if(this.left>P){var R=this.left-P;Q.style.left="calc(50% + "+R+"px)",this.left=P}else Q.style.left="50%"}},{key:"set_values",value:function value(P,Q){var R=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",S=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"",T=4<arguments.length&&void 0!==arguments[4]?arguments[4]:[],U=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0;this.title_name=R,this.title_value=S,this.list_values=T,this.x=P,this.y=Q,this.title_value_first=U,this.refresh()}},{key:"hide_tip",value:function value(){this.container.style.top="0px",this.container.style.left="0px",this.container.style.opacity="0"}},{key:"show_tip",value:function value(){this.container.style.top=this.top+"px",this.container.style.left=this.left+"px",this.container.style.opacity="1"}}]),O}(),G=function(){function O(P){var Q=P.parent,R=void 0===Q?"":Q,S=P.height,T=void 0===S?240:S,U=P.title,V=void 0===U?"":U,W=P.subtitle,X=void 0===W?"":W,Y=P.data,Z=void 0===Y?{}:Y,$=P.format_lambdas,aa=void 0===$?{}:$,ba=P.summary,ca=void 0===ba?[]:ba,da=P.is_navigable,ea=void 0===da?0:da,fa=P.has_legend,ga=void 0===fa?0:fa;w(this,O),this.raw_chart_args=arguments[0],this.parent=document.querySelector(R),this.title=V,this.subtitle=X,this.data=Z,this.format_lambdas=aa,this.specific_values=Z.specific_values||[],this.summary=ca,this.is_navigable=ea,this.is_navigable&&(this.current_index=0),this.has_legend=ga,this.chart_types=["line","scatter","bar","percentage","heatmap"],this.set_margins(T)}return z(O,[{key:"get_different_chart",value:function value(P){if(this.chart_types.includes(P)||console.error("'"+P+"' is not a valid chart type."),P!==this.type)return{bar:["line","scatter","percentage"],line:["scatter","bar","percentage"],scatter:["line","bar","percentage"],percentage:["bar","line","scatter"],heatmap:[]}[this.type].includes(P)||console.error("'"+this.type+"' chart cannot be converted to a '"+P+"' chart."),new N({parent:this.raw_chart_args.parent,title:this.title,data:this.raw_chart_args.data,type:P,height:this.raw_chart_args.height})}},{key:"set_margins",value:function value(P){this.base_height=P,this.height=P-40,this.translate_x=60,this.translate_y=10}},{key:"setup",value:function value(){this.bind_window_events(),this.refresh(!0)}},{key:"bind_window_events",value:function value(){var P=this;window.addEventListener("resize",function(){return P.refresh()}),window.addEventListener("orientationchange",function(){return P.refresh()})}},{key:"refresh",value:function value(){var P=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.setup_base_values(),this.set_width(),this.setup_container(),this.setup_components(),this.setup_values(),this.setup_utils(),this.make_graph_components(P),this.make_tooltip(),0<this.summary.length?this.show_custom_summary():this.show_summary(),this.is_navigable&&this.setup_navigation(P)}},{key:"set_width",value:function value(){var P=this,Q=0;this.specific_values.map(function(R){P.get_strwidth(R.title)>Q&&(Q=P.get_strwidth(R.title)-40)}),this.base_width=this.parent.offsetWidth-Q,this.width=this.base_width-2*this.translate_x}},{key:"setup_base_values",value:function value(){}},{key:"setup_container",value:function value(){this.container=b.create("div",{className:"chart-container",innerHTML:"<h6 class=\"title\">"+this.title+"</h6>\n\t\t\t\t<h6 class=\"sub-title uppercase\">"+this.subtitle+"</h6>\n\t\t\t\t<div class=\"frappe-chart graphics\"></div>\n\t\t\t\t<div class=\"graph-stats-container\"></div>"}),this.parent.innerHTML="",this.parent.appendChild(this.container),this.chart_wrapper=this.container.querySelector(".frappe-chart"),this.stats_wrapper=this.container.querySelector(".graph-stats-container"),this.make_chart_area(),this.make_draw_area()}},{key:"make_chart_area",value:function value(){return this.svg=b.createSVG("svg",{className:"chart",inside:this.chart_wrapper,width:this.base_width,height:this.base_height}),this.svg_defs=b.createSVG("defs",{inside:this.svg}),this.svg}},{key:"make_draw_area",value:function value(){this.draw_area=b.createSVG("g",{className:this.type+"-chart",inside:this.svg,transform:"translate("+this.translate_x+", "+this.translate_y+")"})}},{key:"setup_components",value:function value(){}},{key:"make_tooltip",value:function value(){this.tip=new F({parent:this.chart_wrapper}),this.bind_tooltip()}},{key:"show_summary",value:function value(){}},{key:"show_custom_summary",value:function value(){var P=this;this.summary.map(function(Q){var R=b.create("div",{className:"stats",innerHTML:"<span class=\"indicator "+Q.color+"\">"+Q.title+": "+Q.value+"</span>"});P.stats_wrapper.appendChild(R)})}},{key:"setup_navigation",value:function value(){var P=this,Q=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.make_overlay(),Q&&(this.bind_overlay(),document.addEventListener("keydown",function(R){b.isElementInViewport(P.chart_wrapper)&&("37"==(R=R||window.event).keyCode?P.on_left_arrow():"39"==R.keyCode?P.on_right_arrow():"38"==R.keyCode?P.on_up_arrow():"40"==R.keyCode?P.on_down_arrow():"13"==R.keyCode&&P.on_enter_key())}))}},{key:"make_overlay",value:function value(){}},{key:"bind_overlay",value:function value(){}},{key:"bind_units",value:function value(){}},{key:"on_left_arrow",value:function value(){}},{key:"on_right_arrow",value:function value(){}},{key:"on_up_arrow",value:function value(){}},{key:"on_down_arrow",value:function value(){}},{key:"on_enter_key",value:function value(){}},{key:"get_data_point",value:function value(){var P=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.current_index,Q={index:P},R=this.y[0];return["svg_units","y_tops","values"].map(function(S){var T=S.slice(0,S.length-1);Q[T]=R[S][P]}),Q.label=this.x[P],Q}},{key:"update_current_data_point",value:function value(P){0>(P=parseInt(P))&&(P=0),P>=this.x.length&&(P=this.x.length-1),P!==this.current_index&&(this.current_index=P,b.fire(this.parent,"data-select",this.get_data_point()))}},{key:"get_strwidth",value:function value(P){return 8*(P+"").length}},{key:"setup_utils",value:function value(){}}]),O}(),H=function(){function P(Q){w(this,P);var R=C(this,(P.__proto__||Object.getPrototypeOf(P)).call(this,Q));return R.x=R.data.labels,R.y=R.data.datasets,R.is_series=Q.is_series,R.get_y_label=R.format_lambdas.y_label,R.get_y_tooltip=R.format_lambdas.y_tooltip,R.get_x_tooltip=R.format_lambdas.x_tooltip,R.colors=["green","blue","violet","red","orange","yellow","light-blue","light-green","purple","magenta"],R.zero_line=R.height,R}return B(P,G),z(P,[{key:"setup_values",value:function value(){this.data.datasets.map(function(Q){Q.values=Q.values.map(function(R){return isNaN(R)?0:R})}),this.setup_x(),this.setup_y()}},{key:"setup_x",value:function value(){var Q=this;this.set_avg_unit_width_and_x_offset(),this.x_axis_positions&&(this.x_old_axis_positions=this.x_axis_positions.slice()),this.x_axis_positions=this.x.map(function(R,S){return j(Q.x_offset+S*Q.avg_unit_width)}),this.x_old_axis_positions||(this.x_old_axis_positions=this.x_axis_positions.slice())}},{key:"setup_y",value:function value(){this.y_axis_values&&(this.y_old_axis_values=this.y_axis_values.slice());var Q=this.get_all_y_values();this.y_sums&&0<this.y_sums.length&&(Q=Q.concat(this.y_sums)),this.y_axis_values=this.get_y_axis_points(Q),this.y_old_axis_values||(this.y_old_axis_values=this.y_axis_values.slice());var R=this.y_axis_values,S=R[R.length-1]-R[0];this.multiplier&&(this.old_multiplier=this.multiplier),this.multiplier=this.height/S,this.old_multiplier||(this.old_multiplier=this.multiplier);var T=R.indexOf(0),U=(R[1]-R[0])*this.multiplier;this.zero_line&&(this.old_zero_line=this.zero_line),this.zero_line=this.height-T*U,this.old_zero_line||(this.old_zero_line=this.zero_line)}},{key:"setup_components",value:function value(){A(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"setup_components",this).call(this),this.setup_marker_components(),this.setup_aggregation_components(),this.setup_graph_components()}},{key:"setup_marker_components",value:function value(){this.y_axis_group=b.createSVG("g",{className:"y axis",inside:this.draw_area}),this.x_axis_group=b.createSVG("g",{className:"x axis",inside:this.draw_area}),this.specific_y_group=b.createSVG("g",{className:"specific axis",inside:this.draw_area})}},{key:"setup_aggregation_components",value:function value(){this.sum_group=b.createSVG("g",{className:"data-points",inside:this.draw_area}),this.average_group=b.createSVG("g",{className:"chart-area",inside:this.draw_area})}},{key:"setup_graph_components",value:function value(){var Q=this;this.svg_units_groups=[],this.y.map(function(R,S){Q.svg_units_groups[S]=b.createSVG("g",{className:"data-points data-points-"+S,inside:Q.draw_area})})}},{key:"make_graph_components",value:function value(){var Q=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.make_y_axis(),this.make_x_axis(),this.draw_graph(Q),this.make_y_specifics()}},{key:"make_x_axis",value:function value(){var Q=this,R=0<arguments.length&&void 0!==arguments[0]&&arguments[0],S,T,U,V="";if("span"===this.x_axis_mode?(S=-7,T=this.height+15,U=this.height+25):"tick"===this.x_axis_mode&&(S=this.height,T=6,U=9,V="x-axis-label"),this.x_axis_group.setAttribute("transform","translate(0,"+S+")"),R)this.make_anim_x_axis(T,U,V);else{var W=1.5*this.avg_unit_width;this.x_axis_group.textContent="",this.x.map(function(Y,Z){var $=Q.get_strwidth(Y)+2;if($>W)if(Q.is_series){for(var aa=1;2*($/aa)>W;)aa++;if(0!=Z%aa)return}else Y=Y.slice(0,W/8-3)+" ...";Q.x_axis_group.appendChild(Q.make_x_line(T,U,Y,"x-value-text",V,Q.x_axis_positions[Z]))})}}},{key:"make_y_axis",value:function value(){var Q=this;if(0<arguments.length&&void 0!==arguments[0]&&arguments[0])return this.make_anim_y_axis(),void this.make_anim_y_specifics();var R=this.get_y_axis_line_props(),S=D(R,4),T=S[0],U=S[1],V=S[2],W=S[3];this.y_axis_group.textContent="",this.y_axis_values.map(function(X,Y){Q.y_axis_group.appendChild(Q.make_y_line(W,T,U,X,"y-value-text",V,Q.zero_line-X*Q.multiplier,0===X&&0!==Y))})}},{key:"get_y_axis_line_props",value:function value(){if(0<arguments.length&&void 0!==arguments[0]&&arguments[0])return[this.width,this.width+5,"specific-value",0];var Q,R="",S=0;return"span"===this.y_axis_mode?(Q=this.width+6,S=-6):"tick"===this.y_axis_mode&&(Q=-6,R="y-axis-label"),[Q,-9,R,S]}},{key:"draw_graph",value:function value(){var Q=this,R=0<arguments.length&&void 0!==arguments[0]&&arguments[0];!this.raw_chart_args.hasOwnProperty("init")||this.raw_chart_args.init?R?this.draw_new_graph_and_animate():this.y.map(function(S,T){S.svg_units=[],Q.make_path&&Q.make_path(S,T,Q.x_axis_positions,S.y_tops,S.color||Q.colors[T]),Q.make_new_units(S,T)}):this.y.map(function(S,T){S.svg_units=[],Q.make_path&&Q.make_path(S,T,Q.x_axis_positions,S.y_tops,S.color||Q.colors[T]),Q.make_new_units(S,T),Q.calc_y_dependencies()})}},{key:"draw_new_graph_and_animate",value:function value(){var Q=this,R=[];this.y.map(function(S,T){S.y_tops=Array(S.values.length).fill(Q.zero_line),R.push({values:S.values}),S.svg_units=[],Q.make_path&&Q.make_path(S,T,Q.x_axis_positions,S.y_tops,S.color||Q.colors[T]),Q.make_new_units(S,T)}),setTimeout(function(){Q.update_values(R)},350)}},{key:"setup_navigation",value:function value(Q){var R=this;Q?setTimeout(function(){A(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"setup_navigation",R).call(R,Q)},500):A(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"setup_navigation",this).call(this,Q)}},{key:"make_new_units",value:function value(Q,R){this.make_new_units_for_dataset(this.x_axis_positions,Q.y_tops,Q.color||this.colors[R],R,this.y.length)}},{key:"make_new_units_for_dataset",value:function value(Q,R,S,T,U,V,W,X){var Y=this;V||(V=this.svg_units_groups[T]),W||(W=this.y[T].svg_units),X||(X=this.unit_args),V.textContent="",W.length=0,R.map(function(Z,$){var aa=Y.draw[X.type](Q[$],Z,X.args,S,$,T,U);V.appendChild(aa),W.push(aa)}),this.is_navigable&&this.bind_units(W)}},{key:"make_y_specifics",value:function value(){var Q=this;this.specific_y_group.textContent="",this.specific_values.map(function(R){Q.specific_y_group.appendChild(Q.make_y_line(0,Q.width,Q.width+5,R.title.toUpperCase(),"specific-value","specific-value",Q.zero_line-R.value*Q.multiplier,!1,R.line_type))})}},{key:"bind_tooltip",value:function value(){var Q=this;this.chart_wrapper.addEventListener("mousemove",function(R){var S=b.offset(Q.chart_wrapper),T=R.pageX-S.left-Q.translate_x;R.pageY-S.top-Q.translate_y<Q.height+2*Q.translate_y?Q.map_tooltip_x_position_and_show(T):Q.tip.hide_tip()})}},{key:"map_tooltip_x_position_and_show",value:function value(Q){var R=this;if(this.y_min_tops)for(var T,S=this.x_axis_positions.length-1;0<=S;S--)if(T=this.x_axis_positions[S],Q>T-this.avg_unit_width/2){var U=T+this.translate_x,V=this.y_min_tops[S]+this.translate_y,W=this.x.formatted&&0<this.x.formatted.length?this.x.formatted[S]:this.x[S],X=this.y.map(function(Y,Z){return{title:Y.title,value:Y.formatted?Y.formatted[S]:Y.values[S],color:Y.color||R.colors[Z]}});this.tip.set_values(U,V,W,"",X),this.tip.show_tip();break}}},{key:"show_sums",value:function value(){var Q=this;this.updating=!0,this.y_sums=Array(this.x_axis_positions.length).fill(0),this.y.map(function(R){R.values.map(function(S,T){Q.y_sums[T]+=S})}),this.update_values(),this.sum_units=[],this.make_new_units_for_dataset(this.x_axis_positions,this.y_sums.map(function(R){return j(Q.zero_line-R*Q.multiplier)}),"light-grey",0,1,this.sum_group,this.sum_units),this.updating=!1}},{key:"hide_sums",value:function value(){this.updating||(this.y_sums=[],this.sum_group.textContent="",this.sum_units=[],this.update_values())}},{key:"show_averages",value:function value(){var Q=this;this.old_specific_values=this.specific_values.slice(),this.y.map(function(R,S){var T=0;R.values.map(function(V){T+=V});var U=T/R.values.length;Q.specific_values.push({title:"AVG "+(S+1),line_type:"dashed",value:U,auto:1})}),this.update_values()}},{key:"hide_averages",value:function value(){var Q=this;this.old_specific_values=this.specific_values.slice();var R=[];this.specific_values.map(function(S,T){S.auto&&R.unshift(T)}),R.map(function(S){Q.specific_values.splice(S,1)}),this.update_values()}},{key:"update_values",value:function value(Q,R){var S=this;R||(R=this.x),this.elements_to_animate=[],this.updating=!0,this.old_x_values=this.x.slice(),this.old_y_axis_tops=this.y.map(function(T){return T.y_tops.slice()}),this.old_y_values=this.y.map(function(T){return T.values}),this.no_of_extra_pts=R.length-this.x.length,Q&&this.y.map(function(T,U){T.values=Q[U].values}),R&&(this.x=R),this.setup_x(),this.setup_y(),k(this.x_old_axis_positions,this.x_axis_positions)||(this.make_x_axis(!0),setTimeout(function(){S.updating||S.make_x_axis()},350)),k(this.y_old_axis_values,this.y_axis_values)&&(!this.old_specific_values||k(this.old_specific_values,this.specific_values))||(this.make_y_axis(!0),setTimeout(function(){S.updating||(S.make_y_axis(),S.make_y_specifics())},350)),this.calc_y_dependencies(),this.animate_graphs(),this.run_animation(),this.updating=!1}},{key:"add_data_point",value:function value(Q,R){var S=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this.x.length,T=this.y.map(function(V){return{values:V.values}});T.map(function(V,W){V.values.splice(S,0,Q[W])});var U=this.x.slice();U.splice(S,0,R),this.update_values(T,U)}},{key:"remove_data_point",value:function value(){var Q=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.x.length-1;if(!(3>this.x.length)){var R=this.y.map(function(T){return{values:T.values}});R.map(function(T){T.values.splice(Q,1)});var S=this.x.slice();S.splice(Q,1),this.update_values(R,S)}}},{key:"run_animation",value:function value(){var Q=this,R=b.runSVGAnimation(this.svg,this.elements_to_animate);this.svg.parentNode==this.chart_wrapper&&(this.chart_wrapper.removeChild(this.svg),this.chart_wrapper.appendChild(R)),setTimeout(function(){R.parentNode==Q.chart_wrapper&&(Q.chart_wrapper.removeChild(R),Q.chart_wrapper.appendChild(Q.svg))},250)}},{key:"animate_graphs",value:function value(){var Q=this;this.y.map(function(R,S){var T=Q.calc_old_and_new_postions(R,S),U=D(T,4),V=U[0],W=U[1],X=U[2],Y=U[3];0<=Q.no_of_extra_pts&&(Q.make_path&&Q.make_path(R,S,V,W,R.color||Q.colors[S]),Q.make_new_units_for_dataset(V,W,R.color||Q.colors[S],S,Q.y.length)),R.path&&Q.animate_path(R,S,V,W,X,Y),Q.animate_units(R,S,V,W,X,Y)}),setTimeout(function(){Q.y.map(function(R,S){Q.make_path&&Q.make_path(R,S,Q.x_axis_positions,R.y_tops,R.color||Q.colors[S]),Q.make_new_units(R,S)})},400)}},{key:"animate_path",value:function value(Q,R,S,T,U,V){var W=V.map(function(aa,ba){return U[ba]+","+aa}).join("L"),X=[{unit:Q.path,object:Q,key:"path"},{d:"M"+W},350,"easein"];if(this.elements_to_animate.push(X),Q.region_path){var Y="0,"+this.zero_line+"L",Z="L"+this.width+","+this.zero_line,$=[{unit:Q.region_path,object:Q,key:"region_path"},{d:"M"+Y+W+Z},350,"easein"];this.elements_to_animate.push($)}}},{key:"animate_units",value:function value(Q,R,S,T,U,V){var W=this,X=this.unit_args.type;Q.svg_units.map(function(Y,Z){void 0!==U[Z]&&void 0!==V[Z]&&W.elements_to_animate.push(W.animate[X]({unit:Y,array:Q.svg_units,index:Z},U[Z],V[Z],R))})}},{key:"calc_old_and_new_postions",value:function value(Q,R){var S=this.x_old_axis_positions.slice(),T=this.x_axis_positions.slice(),U=this.old_y_axis_tops[R].slice(),V=Q.y_tops.slice(),W=S[S.length-1],X=U[U.length-1],Y=T[T.length-1],Z=V[V.length-1];if(0<=this.no_of_extra_pts){var $=Array(Math.abs(this.no_of_extra_pts)).fill(W),aa=Array(Math.abs(this.no_of_extra_pts)).fill(X);S=S.concat($),U=U.concat(aa)}else{var ba=Array(Math.abs(this.no_of_extra_pts)).fill(Y),ca=Array(Math.abs(this.no_of_extra_pts)).fill(Z);T=T.concat(ba),V=V.concat(ca)}return[S,U,T,V]}},{key:"make_anim_x_axis",value:function value(Q,R,S){var T=this,U=this.x_old_axis_positions,V=this.x_axis_positions,W=this.old_x_values,X=this.x,Y=U[U.length-1];this.x_axis_group.textContent="",this.make_new_axis_anim_lines(U,V,W,X,Y,function(Z,$,aa){"string"==typeof aa&&(aa=parseInt(aa.substring(0,aa.length-1)));var ba=T.make_x_line(Q,R,Z,"x-value-text",S,$);T.x_axis_group.appendChild(ba),T.elements_to_animate&&T.elements_to_animate.push([{unit:ba,array:[0],index:0},{transform:aa+", 0"},350,"easein","translate",{transform:$+", 0"}])})}},{key:"make_anim_y_axis",value:function value(){var Q=this,R=this.y_old_axis_values.map(function(W){return Q.zero_line-W*Q.multiplier}),S=this.y_axis_values.map(function(W){return Q.zero_line-W*Q.multiplier}),T=this.y_old_axis_values,U=this.y_axis_values,V=R[R.length-1];this.y_axis_group.textContent="",this.make_new_axis_anim_lines(R,S,T,U,V,this.add_and_animate_y_line.bind(this),this.y_axis_group)}},{key:"make_anim_y_specifics",value:function value(){var Q=this;this.specific_y_group.textContent="",this.specific_values.map(function(R){Q.add_and_animate_y_line(R.title,Q.old_zero_line-R.value*Q.old_multiplier,Q.zero_line-R.value*Q.multiplier,0,Q.specific_y_group,R.line_type,!0)})}},{key:"make_new_axis_anim_lines",value:function value(Q,R,S,T,U,V,W){var X,Y,Z=T.length-S.length;if(0<Z)X=R.slice(0,Q.length),Y=T.slice(0,S.length);else{var $=Array(Math.abs(Z)).fill("");Y=T.concat($);var aa=Array(Math.abs(Z)).fill(U+"F");X=R.concat(aa)}if(Y.map(function(da,ea){V(da,Q[ea],X[ea],ea,W)}),0<Z){var ba=T.slice(S.length),ca=R.slice(Q.length);ba.map(function(da,ea){V(da,U,ca[ea],ea,W)})}}},{key:"make_x_line",value:function value(Q,R,S,T,U,V){var W=b.createSVG("line",{x1:0,x2:0,y1:0,y2:Q}),X=b.createSVG("text",{className:T,x:0,y:R,dy:".71em",innerHTML:S}),Y=b.createSVG("g",{className:"tick "+U,transform:"translate("+V+", 0)"});return Y.appendChild(W),Y.appendChild(X),Y}},{key:"make_y_line",value:function value(Q,R,S,T,U,V,W){var X=7<arguments.length&&void 0!==arguments[7]&&arguments[7],Y=8<arguments.length&&void 0!==arguments[8]?arguments[8]:"",Z=b.createSVG("line",{className:"dashed"===Y?"dashed":"",x1:Q,x2:R,y1:0,y2:0}),$=b.createSVG("text",{className:U,x:S,y:0,dy:".32em",innerHTML:T+""}),aa=b.createSVG("g",{className:"tick "+V,transform:"translate(0, "+W+")","stroke-opacity":1});return X&&(Z.style.stroke="rgba(27, 31, 35, 0.6)"),aa.appendChild(Z),aa.appendChild($),aa}},{key:"add_and_animate_y_line",value:function value(Q,R,S,T,U,V){var W=6<arguments.length&&void 0!==arguments[6]&&arguments[6],X=!1;"string"==typeof S&&(S=parseInt(S.substring(0,S.length-1)),X=!0);var Y={transform:"0, "+S};X&&(Y["stroke-opacity"]=0);var $=this.get_y_axis_line_props(W),aa=D($,4),ba=aa[0],ca=aa[1],da=aa[2],ea=aa[3],fa=W?"specific-value":"y-value-text";Q=W?(Q+"").toUpperCase():Q;var ga=this.make_y_line(ea,ba,ca,Q,fa,da,R,0===Q&&0!==T,V);U.appendChild(ga),this.elements_to_animate&&this.elements_to_animate.push([{unit:ga,array:[0],index:0},Y,350,"easein","translate",{transform:"0, "+R}])}},{key:"get_y_axis_points",value:function value(Q){var R=this,S,T,U,V,W=parseInt(Math.max.apply(Math,E(Q))),X=parseInt(Math.min.apply(Math,E(Q)));0<=X&&(X=0);var Y=function l(ea,fa){var ga,ha,ia,ja,ka;if(1>=(ea+"").length)ga=10,ia=5;else{var la=R.calc_upper_bound_and_no_of_parts(ea),ma=D(la,2);ga=ma[0],ia=ma[1]}return ka=ga/ia,ja=R.calc_no_of_parts(fa,ka),ha=ja*ka,[ga,ha,ia,ja,ka]},Z=-1*X;if(Z<=W){var $=Y(W,Z),aa=D($,5);S=aa[1],T=aa[2],U=aa[3],V=aa[4],0==Z&&(S=0,U=0)}else{var ba=Y(Z,W),ca=D(ba,5);S=ca[0],U=ca[2],T=ca[3],V=ca[4]}0!=T%2&&0<U&&T++,0!=U%2&&(U++,S+=V);var da=T+U;return 5<da&&(da/=2,V*=2,T/=2),W<(T-1)*V&&da--,this.get_intervals(-1*S,V,da)}},{key:"get_intervals",value:function value(Q,R,S){for(var T=[],U=0;U<=S;U++)T.push(Q),Q+=R;return T}},{key:"calc_upper_bound_and_no_of_parts",value:function value(Q){var R=Math.pow(10,(Q+"").length-1),S=this.calc_no_of_parts(Q,R);return[R*S,S]}},{key:"calc_no_of_parts",value:function value(Q,R){var S=Math.ceil(Q/R);return 0!=S%2&&S++,S}},{key:"get_optimal_no_of_parts",value:function value(Q){return 5>Q?Q:Q/2}},{key:"set_avg_unit_width_and_x_offset",value:function value(){this.avg_unit_width=this.width/(this.x.length-1),this.x_offset=0}},{key:"get_all_y_values",value:function value(){var Q=[];return this.y.map(function(R){Q=Q.concat(R.values)}),Q.concat(this.specific_values.map(function(R){return R.value}))}},{key:"calc_y_dependencies",value:function value(){var Q=this;this.y_min_tops=Array(this.x_axis_positions.length).fill(9999),this.y.map(function(R){R.y_tops=R.values.map(function(S){return j(Q.zero_line-S*Q.multiplier)}),R.y_tops.map(function(S,T){S<Q.y_min_tops[T]&&(Q.y_min_tops[T]=S)})})}},{key:"get_bar_height_and_y_attr",value:function value(Q){var R,S;return Q<=this.zero_line?(S=Q,0==(R=this.zero_line-Q)&&(S-=R=.01*this.height)):(R=Q-this.zero_line,S=this.zero_line,0===R&&(R=.01*this.height)),[R,S]}},{key:"setup_utils",value:function value(){var Q=this;this.draw={bar:function bar(R,S,T,U,V,W,X){var Y=Q.avg_unit_width-T.space_width,Z=Y/X,aa=Q.get_bar_height_and_y_attr(S),ba=D(aa,2),ca=ba[0],da=ba[1];return b.createSVG("rect",{className:"bar mini fill "+U,"data-point-index":V,x:R-Y/2+Z*W,y:da,width:Z,height:ca})},dot:function dot(R,S,T,U,V){return b.createSVG("circle",{className:"fill "+U,"data-point-index":V,cx:R,cy:S,r:T.radius})}},this.animate={bar:function bar(R,S,T,U){var V=S-Q.avg_unit_width/4,W=Q.avg_unit_width/2/Q.y.length,X=Q.get_bar_height_and_y_attr(T),Y=D(X,2);return S=V+W*U,[R,{width:W,height:Y[0],x:S,y:Y[1]},350,"easein"]},dot:function dot(R,S,T){return[R,{cx:S,cy:T},350,"easein"]}}}}]),P}(),I=function(){function P(Q){w(this,P);var R=C(this,(P.__proto__||Object.getPrototypeOf(P)).call(this,Q));return R.type="bar",R.x_axis_mode=Q.x_axis_mode||"tick",R.y_axis_mode=Q.y_axis_mode||"span",R.setup(),R}return B(P,H),z(P,[{key:"setup_values",value:function value(){A(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"setup_values",this).call(this),this.x_offset=this.avg_unit_width,this.unit_args={type:"bar",args:{space_width:this.avg_unit_width/2}}}},{key:"make_overlay",value:function value(){var Q=this.x.length-1,R=this.y[0].svg_units[Q];this.update_current_data_point(Q),this.overlay&&this.overlay.parentNode.removeChild(this.overlay),this.overlay=R.cloneNode(),this.overlay.style.fill="#000000",this.overlay.style.opacity="0.4",this.draw_area.appendChild(this.overlay)}},{key:"bind_overlay",value:function value(){var Q=this;this.parent.addEventListener("data-select",function(R){Q.update_overlay(R.svg_unit)})}},{key:"bind_units",value:function value(Q){var R=this;Q.map(function(S){S.addEventListener("click",function(){var T=S.getAttribute("data-point-index");R.update_current_data_point(T)})})}},{key:"update_overlay",value:function value(Q){var R=this,S=[];Object.keys(Q.attributes).map(function(T){S.push(Q.attributes[T])}),S.filter(function(T){return T.specified}).map(function(T){R.overlay.setAttribute(T.name,T.nodeValue)})}},{key:"on_left_arrow",value:function value(){this.update_current_data_point(this.current_index-1)}},{key:"on_right_arrow",value:function value(){this.update_current_data_point(this.current_index+1)}},{key:"set_avg_unit_width_and_x_offset",value:function value(){this.avg_unit_width=this.width/(this.x.length+1),this.x_offset=this.avg_unit_width}}]),P}(),J=function(){function P(Q){w(this,P);var R=C(this,(P.__proto__||Object.getPrototypeOf(P)).call(this,Q));return R.x_axis_mode=Q.x_axis_mode||"span",R.y_axis_mode=Q.y_axis_mode||"span",R.show_dots=Q.hasOwnProperty("show_dots")?Q.show_dots:1,R.region_fill=Q.region_fill,Object.getPrototypeOf(R)===P.prototype?(R.dot_radius=Q.dot_radius||4,R.heatline=Q.heatline,R.type="line",R.setup(),R):C(R)}return B(P,H),z(P,[{key:"setup_graph_components",value:function value(){this.setup_path_groups(),A(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"setup_graph_components",this).call(this)}},{key:"setup_path_groups",value:function value(){var Q=this;this.paths_groups=[],this.y.map(function(R,S){Q.paths_groups[S]=b.createSVG("g",{className:"path-group path-group-"+S,inside:Q.draw_area})})}},{key:"setup_values",value:function value(){A(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"setup_values",this).call(this),this.unit_args={type:"dot",args:{radius:this.dot_radius}}}},{key:"make_new_units_for_dataset",value:function value(Q,R,S,T,U,V,W,X){this.show_dots&&A(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"make_new_units_for_dataset",this).call(this,Q,R,S,T,U,V,W,X)}},{key:"make_paths",value:function value(){var Q=this;this.y.map(function(R,S){Q.make_path(R,S,Q.x_axis_positions,R.y_tops,R.color||Q.colors[S])})}},{key:"make_path",value:function value(Q,R,S,T,U){var V=T.map(function(X,Y){return S[Y]+","+X}).join("L");if(this.paths_groups[R].textContent="",Q.path=b.createSVG("path",{inside:this.paths_groups[R],className:"stroke "+U,d:"M"+V}),this.heatline){var W=this.make_gradient(U);Q.path.style.stroke="url(#"+W+")"}this.region_fill&&this.fill_region_for_dataset(Q,R,U,V)}},{key:"fill_region_for_dataset",value:function value(Q,R,S,T){var U=this.make_gradient(S,!0);Q.region_path=b.createSVG("path",{inside:this.paths_groups[R],className:"region-fill",d:"M0,"+this.zero_line+"L"+T+"L"+this.width+","+this.zero_line}),Q.region_path.style.stroke="none",Q.region_path.style.fill="url(#"+U+")"}},{key:"make_gradient",value:function value(Q){var R=1<arguments.length&&void 0!==arguments[1]&&arguments[1],S="path-fill-gradient-"+Q,T=b.createSVG("linearGradient",{inside:this.svg_defs,id:S,x1:0,x2:0,y1:0,y2:1}),U=function(W,X,Y,Z){b.createSVG("stop",{className:"stop-color "+Y,inside:W,offset:X,"stop-opacity":Z})},V=[1,0.6,0.2];return R&&(V=[0.4,0.2,0]),U(T,"0%",Q,V[0]),U(T,"50%",Q,V[1]),U(T,"100%",Q,V[2]),S}}]),P}(),K=function(){function P(Q){w(this,P);var R=C(this,(P.__proto__||Object.getPrototypeOf(P)).call(this,Q));return R.type="scatter",R.dot_radius=Q.dot_radius?Q.dot_radius:8,R.setup(),R}return B(P,J),z(P,[{key:"setup_graph_components",value:function value(){this.setup_path_groups(),A(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"setup_graph_components",this).call(this)}},{key:"setup_path_groups",value:function value(){}},{key:"setup_values",value:function value(){A(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"setup_values",this).call(this),this.unit_args={type:"dot",args:{radius:this.dot_radius}}}},{key:"make_paths",value:function value(){}},{key:"make_path",value:function value(){}}]),P}(),L=function(){function P(Q){w(this,P);var R=C(this,(P.__proto__||Object.getPrototypeOf(P)).call(this,Q));return R.type="percentage",R.get_y_label=R.format_lambdas.y_label,R.get_x_tooltip=R.format_lambdas.x_tooltip,R.get_y_tooltip=R.format_lambdas.y_tooltip,R.max_slices=10,R.max_legend_points=6,R.colors=Q.colors,(!R.colors||R.colors.length<R.data.labels.length)&&(R.colors=["light-blue","blue","violet","red","orange","yellow","green","light-green","purple","magenta"]),R.setup(),R}return B(P,G),z(P,[{key:"make_chart_area",value:function value(){this.chart_wrapper.className+=" graph-focus-margin",this.chart_wrapper.style.marginTop="45px",this.stats_wrapper.className+=" graph-focus-margin",this.stats_wrapper.style.marginBottom="30px",this.stats_wrapper.style.paddingTop="0px"}},{key:"make_draw_area",value:function value(){this.chart_div=b.create("div",{className:"div",inside:this.chart_wrapper}),this.chart=b.create("div",{className:"progress-chart",inside:this.chart_div})}},{key:"setup_components",value:function value(){this.percentage_bar=b.create("div",{className:"progress",inside:this.chart})}},{key:"setup_values",value:function value(){var Q=this;this.slice_totals=[];var R=this.data.labels.map(function(U,V){var W=0;return Q.data.datasets.map(function(X){W+=X.values[V]}),[W,U]}).filter(function(U){return 0<U[0]}),S=R;if(R.length>this.max_slices){R.sort(function(U,V){return V[0]-U[0]}),S=R.slice(0,this.max_slices-1);var T=0;R.slice(this.max_slices-1).map(function(U){T+=U[0]}),S.push([T,"Rest"]),this.colors[this.max_slices-1]="grey"}this.labels=[],S.map(function(U){Q.slice_totals.push(U[0]),Q.labels.push(U[1])}),this.legend_totals=this.slice_totals.slice(0,this.max_legend_points)}},{key:"setup_utils",value:function value(){}},{key:"make_graph_components",value:function value(){var Q=this;this.grand_total=this.slice_totals.reduce(function(R,S){return R+S},0),this.slices=[],this.slice_totals.map(function(R,S){var T=b.create("div",{className:"progress-bar background "+Q.colors[S],inside:Q.percentage_bar,styles:{width:100*R/Q.grand_total+"%"}});Q.slices.push(T)})}},{key:"bind_tooltip",value:function value(){var Q=this;this.slices.map(function(R,S){R.addEventListener("mouseenter",function(){var T=b.offset(Q.chart_wrapper),U=b.offset(R),V=U.left-T.left+R.offsetWidth/2,W=U.top-T.top-6,X=(Q.formatted_labels&&0<Q.formatted_labels.length?Q.formatted_labels[S]:Q.labels[S])+": ",Y=(100*Q.slice_totals[S]/Q.grand_total).toFixed(1);Q.tip.set_values(V,W,X,Y+"%"),Q.tip.show_tip()})})}},{key:"show_summary",value:function value(){var Q=this,R=this.formatted_labels&&0<this.formatted_labels.length?this.formatted_labels:this.labels;this.legend_totals.map(function(S,T){S&&(b.create("div",{className:"stats",inside:Q.stats_wrapper}).innerHTML="<span class=\"indicator "+Q.colors[T]+"\">\n\t\t\t\t\t<span class=\"text-muted\">"+R[T]+":</span>\n\t\t\t\t\t"+S+"\n\t\t\t\t</span>")})}}]),P}(),M=function(){function P(Q){var R=Q.start,S=void 0===R?"":R,T=Q.domain,U=void 0===T?"":T,V=Q.subdomain,W=void 0===V?"":V,X=Q.data,Y=void 0===X?{}:X,Z=Q.discrete_domains,$=void 0===Z?0:Z,aa=Q.count_label,ba=void 0===aa?"":aa;w(this,P);var ca=C(this,(P.__proto__||Object.getPrototypeOf(P)).call(this,arguments[0]));ca.type="heatmap",ca.domain=U,ca.subdomain=W,ca.data=Y,ca.discrete_domains=$,ca.count_label=ba;var da=new Date;return ca.start=S||ca.add_days(da,365),ca.legend_colors=["#ebedf0","#c6e48b","#7bc96f","#239a3b","#196127"],ca.translate_x=0,ca.setup(),ca}return B(P,G),z(P,[{key:"setup_base_values",value:function value(){this.today=new Date,this.start||(this.start=new Date,this.start.setFullYear(this.start.getFullYear()-1)),this.first_week_start=new Date(this.start.toDateString()),this.last_week_start=new Date(this.today.toDateString()),7!==this.first_week_start.getDay()&&this.add_days(this.first_week_start,-1*this.first_week_start.getDay()),7!==this.last_week_start.getDay()&&this.add_days(this.last_week_start,-1*this.last_week_start.getDay()),this.no_of_cols=this.get_weeks_between(this.first_week_start+"",this.last_week_start+"")+1}},{key:"set_width",value:function value(){this.base_width=12*this.no_of_cols,this.discrete_domains&&(this.base_width+=144)}},{key:"setup_components",value:function value(){this.domain_label_group=b.createSVG("g",{className:"domain-label-group chart-label",inside:this.draw_area}),this.data_groups=b.createSVG("g",{className:"data-groups",inside:this.draw_area,transform:"translate(0, 20)"})}},{key:"setup_values",value:function value(){this.domain_label_group.textContent="",this.data_groups.textContent="",this.distribution=this.get_distribution(this.data,this.legend_colors),this.month_names=["January","February","March","April","May","June","July","August","September","October","November","December"],this.render_all_weeks_and_store_x_values(this.no_of_cols)}},{key:"render_all_weeks_and_store_x_values",value:function value(Q){var R=new Date(this.first_week_start);this.week_col=0,this.current_month=R.getMonth(),this.months=[this.current_month+""],this.month_weeks={},this.month_start_points=[],this.month_weeks[this.current_month]=0,this.month_start_points.push(13);for(var S=0;S<Q;S++){var T=void 0,U=0,V=new Date(R),W=this.get_week_squares_group(V,this.week_col),X=D(W,2);T=X[0],U=X[1],this.data_groups.appendChild(T),this.week_col+=1+parseInt(this.discrete_domains&&U),this.month_weeks[this.current_month]++,U&&(this.current_month=(this.current_month+1)%12,this.months.push(this.current_month+""),this.month_weeks[this.current_month]=1),this.add_days(R,7)}this.render_month_labels()}},{key:"get_week_squares_group",value:function value(Q,R){for(var S=0,T=0,U=b.createSVG("g",{className:"data-group",inside:this.data_groups}),V=0,W=0;7>W;W+=1,V+=12){var X=0,Y=0,Z=Math.floor(Q.getTime()/1e3).toFixed(1);this.data[Z]&&(X=this.data[Z],Y=this.get_max_checkpoint(X,this.distribution)),this.data[Math.round(Z)]&&(X=this.data[Math.round(Z)],Y=this.get_max_checkpoint(X,this.distribution)),b.createSVG("rect",{className:"day",inside:U,x:13+12*(R+T),y:V,width:10,height:10,fill:this.legend_colors[Y],"data-date":this.get_dd_mm_yyyy(Q),"data-value":X,"data-day":Q.getDay()});var $=new Date(Q);this.add_days($,1),$.getMonth()-Q.getMonth()&&(S=1,this.discrete_domains&&(T=1),this.month_start_points.push(13+12*(R+T))),Q=$}return[U,S]}},{key:"render_month_labels",value:function value(){var Q=this;this.months.shift(),this.month_start_points.shift(),this.months.pop(),this.month_start_points.pop(),this.month_start_points.map(function(R,S){var T=Q.month_names[Q.months[S]].substring(0,3);b.createSVG("text",{className:"y-value-text",inside:Q.domain_label_group,x:R+12,y:10,dy:".32em",innerHTML:T})})}},{key:"make_graph_components",value:function value(){Array.prototype.slice.call(this.container.querySelectorAll(".graph-stats-container, .sub-title, .title")).map(function(Q){Q.style.display="None"}),this.chart_wrapper.style.marginTop="0px",this.chart_wrapper.style.paddingTop="0px"}},{key:"bind_tooltip",value:function value(){var Q=this;Array.prototype.slice.call(document.querySelectorAll(".data-group .day")).map(function(R){R.addEventListener("mouseenter",function(S){var T=S.target.getAttribute("data-value"),U=S.target.getAttribute("data-date").split("-"),V=Q.month_names[parseInt(U[1])-1].substring(0,3),W=Q.chart_wrapper.getBoundingClientRect(),X=S.target.getBoundingClientRect(),Y=parseInt(S.target.getAttribute("width")),Z=X.left-W.left+(Y+2)/2,$=X.top-W.top-(Y+2)/2,aa=T+" "+Q.count_label,ba=" on "+V+" "+U[0]+", "+U[2];Q.tip.set_values(Z,$,ba,aa,[],1),Q.tip.show_tip()})})}},{key:"update",value:function value(Q){this.data=Q,this.setup_values(),this.bind_tooltip()}},{key:"get_distribution",value:function value(){var Q=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},R=arguments[1],S=Object.keys(Q).map(function(W){return Q[W]}),T=Math.max.apply(Math,E(S)),U=1/(R.length-1),V=[];return R.map(function(W,X){V.push(T*(U*X))}),V}},{key:"get_max_checkpoint",value:function value(Q,R){return R.filter(function(S,T){return 1===T?R[0]<Q:S<=Q}).length-1}},{key:"treat_as_utc",value:function value(Q){var R=new Date(Q);return R.setMinutes(R.getMinutes()-R.getTimezoneOffset()),R}},{key:"get_dd_mm_yyyy",value:function value(Q){var R=Q.getDate(),S=Q.getMonth()+1;return[(9<R?"":"0")+R,(9<S?"":"0")+S,Q.getFullYear()].join("-")}},{key:"get_weeks_between",value:function value(Q,R){return Math.ceil(this.get_days_between(Q,R)/7)}},{key:"get_days_between",value:function value(Q,R){return(this.treat_as_utc(R)-this.treat_as_utc(Q))/864e5}},{key:"add_days",value:function value(Q,R){Q.setDate(Q.getDate()+R)}},{key:"get_month_name",value:function value(){}}]),P}(),N=function O(P){return w(this,O),"line"===P.type?new J(arguments[0]):"bar"===P.type?new I(arguments[0]):"scatter"===P.type?new K(arguments[0]):"percentage"===P.type?new L(arguments[0]):"heatmap"===P.type?new M(arguments[0]):new J(arguments[0])};return N}();
